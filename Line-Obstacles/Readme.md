This is the 2nd version of the working code
